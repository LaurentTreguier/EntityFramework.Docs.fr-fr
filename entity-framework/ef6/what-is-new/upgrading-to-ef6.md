---
title: Mise à niveau vers Entity Framework 6-EF6
description: Mise à niveau vers Entity Framework 6
author: ajcvickers
ms.date: 10/23/2016
uid: ef6/what-is-new/upgrading-to-ef6
ms.openlocfilehash: 14cd0e259832377332f77a199502699d75982bb4
ms.sourcegitcommit: 0a25c03fa65ae6e0e0e3f66bac48d59eceb96a5a
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/14/2020
ms.locfileid: "92064248"
---
# <a name="upgrading-to-entity-framework-6"></a><span data-ttu-id="ad752-103">Mise à niveau vers Entity Framework 6</span><span class="sxs-lookup"><span data-stu-id="ad752-103">Upgrading to Entity Framework 6</span></span>

<span data-ttu-id="ad752-104">Dans les versions précédentes d’EF, le code était divisé entre les bibliothèques principales (principalement System.Data.Entity.dll) fournies dans le cadre des bibliothèques .NET Framework et hors bande (prêtes à l’emploi) (principalement EntityFramework.dll) fournies dans un package NuGet.</span><span class="sxs-lookup"><span data-stu-id="ad752-104">In previous versions of EF the code was split between core libraries (primarily System.Data.Entity.dll) shipped as part of the .NET Framework and out-of-band (OOB) libraries (primarily EntityFramework.dll) shipped in a NuGet package.</span></span> <span data-ttu-id="ad752-105">EF6 prend le code des bibliothèques principales et l’intègre dans les bibliothèques OOB.</span><span class="sxs-lookup"><span data-stu-id="ad752-105">EF6 takes the code from the core libraries and incorporates it into the OOB libraries.</span></span> <span data-ttu-id="ad752-106">Cela était nécessaire pour permettre à EF d’être rendu Open source et pour pouvoir évoluer à un rythme différent de .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ad752-106">This was necessary in order to allow EF to be made open source and for it to be able to evolve at a different pace from .NET Framework.</span></span> <span data-ttu-id="ad752-107">Cela est dû au fait que les applications devront être reconstruites sur les types déplacés.</span><span class="sxs-lookup"><span data-stu-id="ad752-107">The consequence of this is that applications will need to be rebuilt against the moved types.</span></span>

<span data-ttu-id="ad752-108">Cela doit être simple pour les applications qui utilisent DbContext comme fourni dans EF 4,1 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="ad752-108">This should be straightforward for applications that make use of DbContext as shipped in EF 4.1 and later.</span></span> <span data-ttu-id="ad752-109">Un peu plus de travail est nécessaire pour les applications qui utilisent ObjectContext, mais il n’est pas encore difficile de le faire.</span><span class="sxs-lookup"><span data-stu-id="ad752-109">A little more work is required for applications that make use of ObjectContext but it still isn’t hard to do.</span></span>

<span data-ttu-id="ad752-110">Voici une liste de contrôle des éléments que vous devez effectuer pour mettre à niveau une application existante vers EF6.</span><span class="sxs-lookup"><span data-stu-id="ad752-110">Here is a checklist of the things you need to do to upgrade an existing application to EF6.</span></span>

## <a name="1-install-the-ef6-nuget-package"></a><span data-ttu-id="ad752-111">1. installer le package NuGet EF6</span><span class="sxs-lookup"><span data-stu-id="ad752-111">1. Install the EF6 NuGet package</span></span>

<span data-ttu-id="ad752-112">Vous devez effectuer une mise à niveau vers le nouveau runtime Entity Framework 6.</span><span class="sxs-lookup"><span data-stu-id="ad752-112">You need to upgrade to the new Entity Framework 6 runtime.</span></span>

1. <span data-ttu-id="ad752-113">Cliquez avec le bouton droit sur votre projet et sélectionnez **gérer les packages NuGet...**</span><span class="sxs-lookup"><span data-stu-id="ad752-113">Right-click on your project and select **Manage NuGet Packages...**</span></span>  
2. <span data-ttu-id="ad752-114">Sous l’onglet **en ligne** , sélectionnez **EntityFramework** , puis cliquez sur **installer** .</span><span class="sxs-lookup"><span data-stu-id="ad752-114">Under the **Online** tab select **EntityFramework** and click **Install**</span></span>  
   > [!NOTE]
   > <span data-ttu-id="ad752-115">Si une version précédente du package NuGet EntityFramework a été installée, cette opération est mise à niveau vers EF6.</span><span class="sxs-lookup"><span data-stu-id="ad752-115">If a previous version of the EntityFramework NuGet package was installed this will upgrade it to EF6.</span></span>

<span data-ttu-id="ad752-116">Vous pouvez également exécuter la commande suivante à partir de la console du gestionnaire de package :</span><span class="sxs-lookup"><span data-stu-id="ad752-116">Alternatively, you can run the following command from Package Manager Console:</span></span>

``` powershell
Install-Package EntityFramework
```

## <a name="2-ensure-that-assembly-references-to-systemdataentitydll-are-removed"></a><span data-ttu-id="ad752-117">2. Assurez-vous que les références d’assembly aux System.Data.Entity.dll sont supprimées</span><span class="sxs-lookup"><span data-stu-id="ad752-117">2. Ensure that assembly references to System.Data.Entity.dll are removed</span></span>

<span data-ttu-id="ad752-118">L’installation du package NuGet EF6 doit supprimer automatiquement toutes les références à System. Data. Entity de votre projet.</span><span class="sxs-lookup"><span data-stu-id="ad752-118">Installing the EF6 NuGet package should automatically remove any references to System.Data.Entity from your project for you.</span></span>

## <a name="3-swap-any-ef-designer-edmx-models-to-use-ef-6x-code-generation"></a><span data-ttu-id="ad752-119">3. permuter n’importe quel modèle EF Designer (EDMX) pour utiliser la génération de code EF 6. x</span><span class="sxs-lookup"><span data-stu-id="ad752-119">3. Swap any EF Designer (EDMX) models to use EF 6.x code generation</span></span>

<span data-ttu-id="ad752-120">Si vous avez créé des modèles avec le concepteur EF, vous devrez mettre à jour les modèles de génération de code pour générer du code compatible EF6.</span><span class="sxs-lookup"><span data-stu-id="ad752-120">If you have any models created with the EF Designer, you will need to update the code generation templates to generate EF6 compatible code.</span></span>

> [!NOTE]
> <span data-ttu-id="ad752-121">Il n’existe actuellement que les modèles de générateur de DbContext EF 6. x disponibles pour Visual Studio 2012 et 2013.</span><span class="sxs-lookup"><span data-stu-id="ad752-121">There are currently only EF 6.x DbContext Generator templates available for Visual Studio 2012 and 2013.</span></span>

1. <span data-ttu-id="ad752-122">Supprimer les modèles de génération de code existants.</span><span class="sxs-lookup"><span data-stu-id="ad752-122">Delete existing code-generation templates.</span></span> <span data-ttu-id="ad752-123">Ces fichiers sont généralement nommés \*\* \<edmx_file_name\> . TT\*\* et \*\* \<edmx_file_name\> . Context.tt\*\* et sont imbriqués sous votre fichier edmx dans Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="ad752-123">These files will typically be named **\<edmx_file_name\>.tt** and **\<edmx_file_name\>.Context.tt** and be nested under your edmx file in Solution Explorer.</span></span> <span data-ttu-id="ad752-124">Vous pouvez sélectionner les modèles dans Explorateur de solutions et appuyer sur la touche **Suppr** pour les supprimer.</span><span class="sxs-lookup"><span data-stu-id="ad752-124">You can select the templates in Solution Explorer and press the **Del** key to delete them.</span></span>  
   > [!NOTE]
   > <span data-ttu-id="ad752-125">Dans les projets de site Web, les modèles ne sont pas imbriqués sous votre fichier edmx, mais sont listés en même temps dans Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="ad752-125">In Web Site projects the templates will not be nested under your edmx file, but listed alongside it in Solution Explorer.</span></span>  

   > [!NOTE]
   > <span data-ttu-id="ad752-126">Dans les projets VB.NET, vous devez activer « afficher tous les fichiers » pour pouvoir voir les fichiers de modèles imbriqués.</span><span class="sxs-lookup"><span data-stu-id="ad752-126">In VB.NET projects you will need to enable 'Show All Files' to be able to see the nested template files.</span></span>
2. <span data-ttu-id="ad752-127">Ajoutez le modèle de génération de code EF 6. x approprié.</span><span class="sxs-lookup"><span data-stu-id="ad752-127">Add the appropriate EF 6.x code generation template.</span></span> <span data-ttu-id="ad752-128">Ouvrez votre modèle dans le concepteur EF, cliquez avec le bouton droit sur l’aire de conception, puis sélectionnez **Ajouter un élément de génération de code...**</span><span class="sxs-lookup"><span data-stu-id="ad752-128">Open your model in the EF Designer, right-click on the design surface and select **Add Code Generation Item...**</span></span>
    - <span data-ttu-id="ad752-129">Si vous utilisez l’API DbContext (recommandé), le **Générateur de DbContext EF 6. x** sera disponible sous l’onglet **données** .</span><span class="sxs-lookup"><span data-stu-id="ad752-129">If you are using the DbContext API (recommended) then **EF 6.x DbContext Generator** will be available under the **Data** tab.</span></span>  
      > [!NOTE]
      > <span data-ttu-id="ad752-130">Si vous utilisez Visual Studio 2012, vous devrez installer les outils EF 6 pour obtenir ce modèle.</span><span class="sxs-lookup"><span data-stu-id="ad752-130">If you are using Visual Studio 2012, you will need to install the EF 6 Tools to have this template.</span></span> <span data-ttu-id="ad752-131">Pour plus d’informations, consultez [obtenir Entity Framework](xref:ef6/fundamentals/install) .</span><span class="sxs-lookup"><span data-stu-id="ad752-131">See [Get Entity Framework](xref:ef6/fundamentals/install) for details.</span></span>  

    - <span data-ttu-id="ad752-132">Si vous utilisez l’API ObjectContext, vous devrez sélectionner l’onglet **Online** et rechercher le **Générateur EntityObject EF 6. x**.</span><span class="sxs-lookup"><span data-stu-id="ad752-132">If you are using the ObjectContext API then you will need to select the **Online** tab and search for **EF 6.x EntityObject Generator**.</span></span>  
3. <span data-ttu-id="ad752-133">Si vous avez appliqué des personnalisations aux modèles de génération de code, vous devez les réappliquer aux modèles mis à jour.</span><span class="sxs-lookup"><span data-stu-id="ad752-133">If you applied any customizations to the code generation templates you will need to re-apply them to the updated templates.</span></span>

## <a name="4-update-namespaces-for-any-core-ef-types-being-used"></a><span data-ttu-id="ad752-134">4. mettre à jour les espaces de noms pour tous les types EF de base utilisés</span><span class="sxs-lookup"><span data-stu-id="ad752-134">4. Update namespaces for any core EF types being used</span></span>

<span data-ttu-id="ad752-135">Les espaces de noms pour DbContext et les types Code First n’ont pas changé.</span><span class="sxs-lookup"><span data-stu-id="ad752-135">The namespaces for DbContext and Code First types have not changed.</span></span> <span data-ttu-id="ad752-136">Cela signifie que pour de nombreuses applications qui utilisent EF 4,1 ou une version ultérieure, vous n’aurez pas besoin de modifier quoi que ce soit.</span><span class="sxs-lookup"><span data-stu-id="ad752-136">This means for many applications that use EF 4.1 or later you will not need to change anything.</span></span>

<span data-ttu-id="ad752-137">Les types comme ObjectContext qui étaient précédemment dans System.Data.Entity.dll ont été déplacés vers de nouveaux espaces de noms.</span><span class="sxs-lookup"><span data-stu-id="ad752-137">Types like ObjectContext that were previously in System.Data.Entity.dll have been moved to new namespaces.</span></span> <span data-ttu-id="ad752-138">Cela signifie que vous devrez peut-être mettre à jour vos directives *using* ou *Import* pour créer des EF6.</span><span class="sxs-lookup"><span data-stu-id="ad752-138">This means you may need to update your *using* or *Import* directives to build against EF6.</span></span>

<span data-ttu-id="ad752-139">La règle générale pour les modifications d’espace de noms est que tout type dans System. Data. \* est déplacé vers System. Data. Entity. Core. \*.</span><span class="sxs-lookup"><span data-stu-id="ad752-139">The general rule for namespace changes is that any type in System.Data.\* is moved to System.Data.Entity.Core.\*.</span></span> <span data-ttu-id="ad752-140">En d’autres termes, il suffit d’insérer **Entity. Core.**</span><span class="sxs-lookup"><span data-stu-id="ad752-140">In other words, just insert **Entity.Core.**</span></span> <span data-ttu-id="ad752-141">après System. Data.</span><span class="sxs-lookup"><span data-stu-id="ad752-141">after System.Data.</span></span> <span data-ttu-id="ad752-142">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="ad752-142">For example:</span></span>

- <span data-ttu-id="ad752-143">System. Data. EntityException => System. Data. **Entity. Core**. EntityException</span><span class="sxs-lookup"><span data-stu-id="ad752-143">System.Data.EntityException => System.Data.**Entity.Core**.EntityException</span></span>  
- <span data-ttu-id="ad752-144">System. Data. Objects. ObjectContext => System. Data. **Entity. Core**. Objects. ObjectContext</span><span class="sxs-lookup"><span data-stu-id="ad752-144">System.Data.Objects.ObjectContext => System.Data.**Entity.Core**.Objects.ObjectContext</span></span>  
- <span data-ttu-id="ad752-145">System. Data. Objects. DataClasses. RelationshipManager => System. Data. **Entity. Core**. Objets. DataClasses. RelationshipManager</span><span class="sxs-lookup"><span data-stu-id="ad752-145">System.Data.Objects.DataClasses.RelationshipManager => System.Data.**Entity.Core**.Objects.DataClasses.RelationshipManager</span></span>  

<span data-ttu-id="ad752-146">Ces types se trouvent dans les espaces de noms de *base* , car ils ne sont pas utilisés directement pour la plupart des applications basées sur DbContext.</span><span class="sxs-lookup"><span data-stu-id="ad752-146">These types are in the *Core* namespaces because they are not used directly for most DbContext-based applications.</span></span> <span data-ttu-id="ad752-147">Certains types qui faisaient partie de System.Data.Entity.dll sont toujours utilisés communément et directement pour les applications basées sur DbContext. ils n’ont donc pas été déplacés dans les espaces de noms de *base* .</span><span class="sxs-lookup"><span data-stu-id="ad752-147">Some types that were part of System.Data.Entity.dll are still used commonly and directly for DbContext-based applications and so have not been moved into the *Core* namespaces.</span></span> <span data-ttu-id="ad752-148">Ces règles sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="ad752-148">These are:</span></span>

- <span data-ttu-id="ad752-149">System. Data. EntityState => System. Data. **Entité**. EntityState</span><span class="sxs-lookup"><span data-stu-id="ad752-149">System.Data.EntityState => System.Data.**Entity**.EntityState</span></span>  
- <span data-ttu-id="ad752-150">System. Data. Objects. DataClasses. EdmFunctionAttribute => System. Data. **Entité. DbFunctionAttribute**</span><span class="sxs-lookup"><span data-stu-id="ad752-150">System.Data.Objects.DataClasses.EdmFunctionAttribute => System.Data.**Entity.DbFunctionAttribute**</span></span>  
  > [!NOTE]
  > <span data-ttu-id="ad752-151">Cette classe a été renommée ; une classe portant l’ancien nom existe toujours et fonctionne, mais elle est désormais marquée comme obsolète.</span><span class="sxs-lookup"><span data-stu-id="ad752-151">This class has been renamed; a class with the old name still exists and works, but it now marked as obsolete.</span></span>  
- <span data-ttu-id="ad752-152">System. Data. Objects. EntityFunctions => System. Data. **Entité. DbFunctions**</span><span class="sxs-lookup"><span data-stu-id="ad752-152">System.Data.Objects.EntityFunctions => System.Data.**Entity.DbFunctions**</span></span>  
  > [!NOTE]
  > <span data-ttu-id="ad752-153">Cette classe a été renommée ; une classe portant l’ancien nom existe toujours et fonctionne, mais elle est désormais marquée comme obsolète.)</span><span class="sxs-lookup"><span data-stu-id="ad752-153">This class has been renamed; a class with the old name still exists and works, but it now marked as obsolete.)</span></span>  
- <span data-ttu-id="ad752-154">Les classes spatiales (par exemple, DbGeography, DbGeometry) ont été déplacées de System. Data. spatial => System. Data. **Entité**. Adjacent</span><span class="sxs-lookup"><span data-stu-id="ad752-154">Spatial classes (for example, DbGeography, DbGeometry) have moved from System.Data.Spatial => System.Data.**Entity**.Spatial</span></span>

> [!NOTE]
> <span data-ttu-id="ad752-155">Certains types de l’espace de noms System. Data se trouvent dans System.Data.dll qui n’est pas un assembly EF.</span><span class="sxs-lookup"><span data-stu-id="ad752-155">Some types in the System.Data namespace are in System.Data.dll which is not an EF assembly.</span></span> <span data-ttu-id="ad752-156">Ces types n’ont pas été déplacés et leurs espaces de noms restent inchangés.</span><span class="sxs-lookup"><span data-stu-id="ad752-156">These types have not moved and so their namespaces remain unchanged.</span></span>
