---
title: Fonctions de base de données-EF Core
description: Informations sur les fonctions de base de données prises en charge dans EF Core la traduction des requêtes
author: smitpatel
ms.date: 11/10/2020
uid: core/querying/database-functions
ms.openlocfilehash: 34ced2a602168f6ed84763c046ef581cb87026e8
ms.sourcegitcommit: 42bbf7f68e92c364c5fff63092d3eb02229f568d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/11/2020
ms.locfileid: "94503797"
---
# <a name="database-functions"></a><span data-ttu-id="fc614-103">Fonctions de base de données</span><span class="sxs-lookup"><span data-stu-id="fc614-103">Database Functions</span></span>

<span data-ttu-id="fc614-104">Les fonctions de base de données sont l’équivalent de la base de données des [méthodes C#](/dotnet/csharp/programming-guide/classes-and-structs/methods).</span><span class="sxs-lookup"><span data-stu-id="fc614-104">Database functions are the database equivalent of [C# methods](/dotnet/csharp/programming-guide/classes-and-structs/methods).</span></span> <span data-ttu-id="fc614-105">Une fonction de base de données peut être appelée avec zéro ou plusieurs paramètres et calcule le résultat en fonction des valeurs de paramètre.</span><span class="sxs-lookup"><span data-stu-id="fc614-105">A database function can be invoked with zero or more parameters and it computes the result based on the parameter values.</span></span> <span data-ttu-id="fc614-106">La plupart des bases de données, qui utilisent SQL pour l’interrogation, prennent en charge les fonctions de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-106">Most databases, which use SQL for querying have support for database functions.</span></span> <span data-ttu-id="fc614-107">Par conséquent, SQL généré par EF Core la traduction de requête permet également d’appeler des fonctions de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-107">So SQL generated by EF Core query translation also allows invoking database functions.</span></span> <span data-ttu-id="fc614-108">Les méthodes C# n’ont pas besoin de se traduire strictement en fonctions de base de données dans EF Core.</span><span class="sxs-lookup"><span data-stu-id="fc614-108">C# methods don't have to translate strictly to database functions in EF Core.</span></span>

- <span data-ttu-id="fc614-109">Une méthode C# ne peut pas avoir une fonction de base de données équivalente.</span><span class="sxs-lookup"><span data-stu-id="fc614-109">A C# method may not have an equivalent database function.</span></span>
  - <span data-ttu-id="fc614-110"><xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> la méthode se traduit par une vérification de valeur null et une comparaison avec une chaîne vide dans la base de données plutôt qu’une fonction.</span><span class="sxs-lookup"><span data-stu-id="fc614-110"><xref:System.String.IsNullOrEmpty%2A?displayProperty=nameWithType> method translates to a null check and a comparison with an empty string in the database rather than a function.</span></span>
  - <span data-ttu-id="fc614-111"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> la méthode n’a pas d’équivalent de base de données, car la comparaison de chaînes ne peut pas être représentée ou simulée facilement dans une base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-111"><xref:System.String.Equals(System.String,System.StringComparison)?displayProperty=nameWithType> method doesn't have database equivalent since string comparison can't be represented or mimicked easily in a database.</span></span>
- <span data-ttu-id="fc614-112">Une fonction de base de données ne peut pas avoir une méthode C# équivalente.</span><span class="sxs-lookup"><span data-stu-id="fc614-112">A database function may not have an equivalent C# method.</span></span> <span data-ttu-id="fc614-113">L' `??` opérateur en C#, qui n’a pas de méthode, se traduit par la `COALESCE` fonction dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-113">The `??` operator in C#, which doesn't have any method, translates to the `COALESCE` function in the database.</span></span>

## <a name="types-of-database-functions"></a><span data-ttu-id="fc614-114">Types de fonctions de base de données</span><span class="sxs-lookup"><span data-stu-id="fc614-114">Types of database functions</span></span>

<span data-ttu-id="fc614-115">EF Core génération SQL prend en charge un sous-ensemble de fonctions qui peuvent être utilisées dans les bases de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-115">EF Core SQL generation supports a subset of functions that can be used in databases.</span></span> <span data-ttu-id="fc614-116">Cette limitation provient de la possibilité de représenter une requête dans LINQ pour la fonction de base de données donnée.</span><span class="sxs-lookup"><span data-stu-id="fc614-116">This limitation comes from the ability to represent a query in LINQ for the given database function.</span></span> <span data-ttu-id="fc614-117">En outre, chaque base de données a une prise en charge différente des fonctions de base de données, de sorte que EF Core fournit un sous-ensemble commun.</span><span class="sxs-lookup"><span data-stu-id="fc614-117">Further, each database has varying support of database functions, so EF Core provides a common subset.</span></span> <span data-ttu-id="fc614-118">Un fournisseur de base de données est libre d’étendre EF Core génération SQL pour prendre en charge davantage de modèles.</span><span class="sxs-lookup"><span data-stu-id="fc614-118">A database provider is free to extend EF Core SQL generation to support more patterns.</span></span> <span data-ttu-id="fc614-119">Voici les types de fonctions de base de données que EF Core prend en charge et identifie de manière unique.</span><span class="sxs-lookup"><span data-stu-id="fc614-119">Following are the types of database functions EF Core supports and uniquely identifies.</span></span> <span data-ttu-id="fc614-120">Ces termes permettent également de comprendre les traductions intégrées aux fournisseurs de EF Core.</span><span class="sxs-lookup"><span data-stu-id="fc614-120">These terms also help in understanding what translations come built in with EF Core providers.</span></span>

### <a name="built-in-vs-user-defined-functions"></a><span data-ttu-id="fc614-121">Fonctions intégrées vs définies par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="fc614-121">Built-in vs user-defined functions</span></span>

<span data-ttu-id="fc614-122">Les fonctions intégrées sont fournies avec la base de données prédéfinie, mais les fonctions définies par l’utilisateur sont définies explicitement par l’utilisateur dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-122">Built-in functions come with database predefined, but user-defined functions are explicitly defined by the user in the database.</span></span> <span data-ttu-id="fc614-123">Lorsque EF Core traduit des requêtes pour utiliser des fonctions de base de données, il utilise des fonctions intégrées pour s’assurer que la fonction est toujours disponible dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-123">When EF Core translates queries to use database functions, it uses built-in functions to make sure that the function is always available on the database.</span></span> <span data-ttu-id="fc614-124">La distinction entre les fonctions intégrées est nécessaire dans certaines bases de données pour générer correctement SQL.</span><span class="sxs-lookup"><span data-stu-id="fc614-124">The distinction of built-in functions is necessary in some databases to generate SQL correctly.</span></span> <span data-ttu-id="fc614-125">Par exemple, SqlServer requiert que chaque fonction définie par l’utilisateur soit appelée avec un nom qualifié par un schéma.</span><span class="sxs-lookup"><span data-stu-id="fc614-125">For example SqlServer requires that every user-defined function is invoked with a schema-qualified name.</span></span> <span data-ttu-id="fc614-126">Toutefois, les fonctions intégrées dans SqlServer n’ont pas de schéma.</span><span class="sxs-lookup"><span data-stu-id="fc614-126">But built-in functions in SqlServer don't have a schema.</span></span> <span data-ttu-id="fc614-127">PostgreSQL définit la fonction intégrée dans le `public` schéma, mais elles peuvent être appelées avec des noms qualifiés de schéma.</span><span class="sxs-lookup"><span data-stu-id="fc614-127">PostgreSQL defines built-in function in the `public` schema but they can be invoked with schema-qualified names.</span></span>

### <a name="aggregate-vs-scalar-vs-table-valued-functions"></a><span data-ttu-id="fc614-128">Fonctions agrégées vs scalaires vs</span><span class="sxs-lookup"><span data-stu-id="fc614-128">Aggregate vs scalar vs table-valued functions</span></span>

- <span data-ttu-id="fc614-129">Les fonctions scalaires prennent des valeurs scalaires, comme des paramètres ou des chaînes, et retournent une valeur scalaire comme résultat.</span><span class="sxs-lookup"><span data-stu-id="fc614-129">Scalar functions take scalar values - like integers or strings - as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="fc614-130">Les fonctions scalaires peuvent être utilisées n’importe où dans SQL où une valeur scalaire peut être passée.</span><span class="sxs-lookup"><span data-stu-id="fc614-130">Scalar functions can be used anywhere in SQL where a scalar value can be passed.</span></span>
- <span data-ttu-id="fc614-131">Les fonctions d’agrégation prennent un flux de valeurs scalaires en tant que paramètres et retournent une valeur scalaire comme résultat.</span><span class="sxs-lookup"><span data-stu-id="fc614-131">Aggregate functions take a stream of scalar values as parameters and return a scalar value as the result.</span></span> <span data-ttu-id="fc614-132">Les fonctions d’agrégation sont appliquées à l’ensemble du jeu de résultats de la requête ou à un groupe de valeurs générées par l’opérateur Applying `GROUP BY` .</span><span class="sxs-lookup"><span data-stu-id="fc614-132">Aggregate functions are applied on the whole query result set or on a group of values generated by applying `GROUP BY` operator.</span></span>
- <span data-ttu-id="fc614-133">Les fonctions table acceptent des valeurs scalaires comme paramètres et retournent un flux de lignes en tant que résultat.</span><span class="sxs-lookup"><span data-stu-id="fc614-133">Table-valued functions take scalar values as parameter(s) and return a stream of rows as the result.</span></span> <span data-ttu-id="fc614-134">Les fonctions table sont utilisées comme une clause table source in `FROM` .</span><span class="sxs-lookup"><span data-stu-id="fc614-134">Table-valued functions are used as a table source in `FROM` clause.</span></span>

### <a name="niladic-functions"></a><span data-ttu-id="fc614-135">Fonctions niladic</span><span class="sxs-lookup"><span data-stu-id="fc614-135">Niladic functions</span></span>

<span data-ttu-id="fc614-136">Les fonctions niladic sont des fonctions de base de données spéciales qui n’ont pas de paramètres et doivent être appelées sans parenthèses.</span><span class="sxs-lookup"><span data-stu-id="fc614-136">Niladic functions are special database functions that don't have any parameters and must be invoked without parenthesis.</span></span> <span data-ttu-id="fc614-137">Elles sont similaires à l’accès aux propriétés/champs sur une instance en C#.</span><span class="sxs-lookup"><span data-stu-id="fc614-137">They're similar to property/field access on an instance in C#.</span></span> <span data-ttu-id="fc614-138">Les fonctions niladic diffèrent des fonctions sans paramètre, car cette dernière nécessite des parenthèses vides.</span><span class="sxs-lookup"><span data-stu-id="fc614-138">Niladic functions differ from parameter-less functions as the latter require empty parenthesis.</span></span> <span data-ttu-id="fc614-139">Il n’existe pas de nom spécial pour les fonctions de base de données qui nécessitent toujours des parenthèses.</span><span class="sxs-lookup"><span data-stu-id="fc614-139">There's no special name for database functions that requires parenthesis always.</span></span> <span data-ttu-id="fc614-140">Une autre sous-partie des fonctions de base de données basée sur le nombre de paramètres est variadiques functions.</span><span class="sxs-lookup"><span data-stu-id="fc614-140">Another subset of database functions based on parameter count is variadic functions.</span></span> <span data-ttu-id="fc614-141">Les fonctions variadiques peuvent prendre un nombre variable de paramètres lorsqu’elles sont appelées.</span><span class="sxs-lookup"><span data-stu-id="fc614-141">Variadic functions can take varying number of parameters when invoked.</span></span>

## <a name="database-function-mappings-in-ef-core"></a><span data-ttu-id="fc614-142">Mappages de fonctions de base de données dans EF Core</span><span class="sxs-lookup"><span data-stu-id="fc614-142">Database function mappings in EF Core</span></span>

<span data-ttu-id="fc614-143">EF Core prend en charge trois méthodes différentes de mappage entre les fonctions C# et les fonctions de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-143">EF Core supports three different ways of mapping between C# functions and database functions.</span></span>

### <a name="built-in-function-mapping"></a><span data-ttu-id="fc614-144">Mappage de fonctions intégrées</span><span class="sxs-lookup"><span data-stu-id="fc614-144">Built-in function mapping</span></span>

<span data-ttu-id="fc614-145">Par défaut EF Core fournisseurs fournissent des mappages pour diverses fonctions intégrées sur des types primitifs.</span><span class="sxs-lookup"><span data-stu-id="fc614-145">By default EF Core providers provide mappings for various built-in functions over primitive types.</span></span> <span data-ttu-id="fc614-146">Par exemple, <xref:System.String.ToLower?displayProperty=nameWithType> se traduit par `LOWER` dans SqlServer.</span><span class="sxs-lookup"><span data-stu-id="fc614-146">For example, <xref:System.String.ToLower?displayProperty=nameWithType> translates to `LOWER` in SqlServer.</span></span> <span data-ttu-id="fc614-147">Cette fonctionnalité permet aux utilisateurs d’écrire des requêtes dans LINQ en toute transparence.</span><span class="sxs-lookup"><span data-stu-id="fc614-147">This functionality allows users to write queries in LINQ seamlessly.</span></span> <span data-ttu-id="fc614-148">Nous fournissons généralement une traduction dans la base de données qui donne le même résultat que celui fourni par la fonction C# côté client.</span><span class="sxs-lookup"><span data-stu-id="fc614-148">We usually provide a translation in the database that gives the same result as what the C# function provides on the client side.</span></span> <span data-ttu-id="fc614-149">Parfois, pour y parvenir, la traduction réelle peut être plus complexe qu’une fonction de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-149">Sometimes, to achieve that, the actual translation could be something more complicated than a database function.</span></span> <span data-ttu-id="fc614-150">Dans certains scénarios, nous fournissons également la traduction la plus appropriée plutôt que la correspondance de la sémantique C#.</span><span class="sxs-lookup"><span data-stu-id="fc614-150">In some scenarios, we also provide the most appropriate translation rather than matching C# semantics.</span></span> <span data-ttu-id="fc614-151">La même fonctionnalité est également utilisée pour fournir des traductions communes pour certains des accès aux membres C#.</span><span class="sxs-lookup"><span data-stu-id="fc614-151">The same feature is also used to provide common translations for some of the C# member accesses.</span></span> <span data-ttu-id="fc614-152">Par exemple, <xref:System.String.Length?displayProperty=nameWithType> se traduit par `LEN` dans SqlServer.</span><span class="sxs-lookup"><span data-stu-id="fc614-152">For example, <xref:System.String.Length?displayProperty=nameWithType> translates to `LEN` in SqlServer.</span></span> <span data-ttu-id="fc614-153">Hormis les fournisseurs, les enregistreurs de plug-ins peuvent également ajouter des traductions supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="fc614-153">Apart from providers, plugin writers can also add additional translations.</span></span> <span data-ttu-id="fc614-154">Cette extensibilité est utile lorsque les plug-ins ajoutent la prise en charge d’autres types en tant que types primitifs et souhaitent traduire les méthodes sur eux.</span><span class="sxs-lookup"><span data-stu-id="fc614-154">This extensibility is useful when plugins add support for more types as primitive types and want to translate methods over them.</span></span>

### <a name="effunctions-mapping"></a><span data-ttu-id="fc614-155">EF. Mappage des fonctions</span><span class="sxs-lookup"><span data-stu-id="fc614-155">EF.Functions mapping</span></span>

<span data-ttu-id="fc614-156">Dans la mesure où toutes les fonctions de base de données n’ont pas d’équivalents C#, les fournisseurs EF Core ont des méthodes C# spéciales pour appeler certaines fonctions de base de données.</span><span class="sxs-lookup"><span data-stu-id="fc614-156">Since not all database functions have equivalent C# functions, EF Core providers have special C# methods to invoke certain database functions.</span></span> <span data-ttu-id="fc614-157">Ces méthodes sont définies comme méthodes d’extension sur `EF.Functions` pour être utilisées dans les requêtes LINQ.</span><span class="sxs-lookup"><span data-stu-id="fc614-157">These methods are defined as extension methods over `EF.Functions` to be used in LINQ queries.</span></span> <span data-ttu-id="fc614-158">Ces méthodes sont spécifiques au fournisseur, car elles sont étroitement liées à des fonctions de base de données particulières.</span><span class="sxs-lookup"><span data-stu-id="fc614-158">These methods are provider-specific as they're closely tied with particular database functions.</span></span> <span data-ttu-id="fc614-159">Par conséquent, une méthode qui fonctionne pour un fournisseur ne fonctionnera probablement pas pour un autre fournisseur.</span><span class="sxs-lookup"><span data-stu-id="fc614-159">So a method that works for one provider will likely not work for any other provider.</span></span> <span data-ttu-id="fc614-160">En outre, étant donné que l’objectif de ces méthodes est d’appeler une fonction de base de données dans la requête traduite, essayer de les évaluer sur le client entraîne une exception.</span><span class="sxs-lookup"><span data-stu-id="fc614-160">Further, since the intention of these methods is to invoke a database function in the translated query, trying to evaluate them on the client results in an exception.</span></span>

### <a name="user-defined-function-mapping"></a><span data-ttu-id="fc614-161">Mappage des fonctions définies par l’utilisateur</span><span class="sxs-lookup"><span data-stu-id="fc614-161">User-defined function mapping</span></span>

<span data-ttu-id="fc614-162">Outre les mappages fournis par les fournisseurs de EF Core, les utilisateurs peuvent également définir un mappage personnalisé.</span><span class="sxs-lookup"><span data-stu-id="fc614-162">Apart from mappings provided by EF Core providers, users can also define custom mapping.</span></span> <span data-ttu-id="fc614-163">Un mappage défini par l’utilisateur étend la traduction des requêtes en fonction des besoins de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="fc614-163">A user-defined mapping extends the query translation according to the user needs.</span></span> <span data-ttu-id="fc614-164">Cette fonctionnalité est utile lorsqu’il existe des fonctions définies par l’utilisateur dans la base de données, que l’utilisateur souhaite appeler à partir de leur requête LINQ.</span><span class="sxs-lookup"><span data-stu-id="fc614-164">This functionality is useful when there are user-defined functions in the database, which the user wants to invoke from their LINQ query.</span></span>

## <a name="see-also"></a><span data-ttu-id="fc614-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fc614-165">See also</span></span>

- [<span data-ttu-id="fc614-166">Mappages de fonctions intégrées SqlServer</span><span class="sxs-lookup"><span data-stu-id="fc614-166">SqlServer built-in function mappings</span></span>](xref:core/providers/sql-server/functions)
- [<span data-ttu-id="fc614-167">Mappages de fonctions intégrées SQLite</span><span class="sxs-lookup"><span data-stu-id="fc614-167">Sqlite built-in function mappings</span></span>](xref:core/providers/sqlite/functions)
- [<span data-ttu-id="fc614-168">Mappages de fonctions intégrées Cosmos</span><span class="sxs-lookup"><span data-stu-id="fc614-168">Cosmos built-in function mappings</span></span>](xref:core/providers/cosmos/functions)
